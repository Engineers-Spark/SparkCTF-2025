from Crypto.Util.number import *
from secret import FLAG

# n = 56297231307007894600463206039875560993799532373050864249912506755013177815105498668396623983865556816712032808175743217257997177361441403910571984541787141843710685756490414619109598862486769844320079745933147515497944248153620569050072258547939144936459549206418861852890174165068253888863089420217789929783
# e = 65537
# enc = [15488196164097903202679433156100136972321547471197069421052193847553046414680360737201880399308572195890840336589497424839074368826443047888500290281235387129670053663836063414700815520439320063661198396910401160856656002398641801319914789137082301118015098641709168168023650916430545655234153427556585449140, 17981686003831576655750724541061136638214489541661706786098819847990502957399005445309254975897193297209262147049071873110405255336072168171567936821384167870668543030758469068863529559687313759241408815657830831214395081308022392528352578276224635898131983803715407795533203050205772093146313860934212354232, 36335613174238174028652715526868634879092478833515889827542697222280923254635242585965307423959540500341026011449027887600962342978956111965020503867707512009160759389640245039210683771157918362780325154160645087402321570254844795752246931304586857955616647689768129102738513700764695931591131869869497167186, 36676057632257729237212899844289936295388079984278743129066287791890821307569718588467830549766980497620705990504075904454058628280997611559446647008712472424650357071787717497283310906385314513250457003598337633815988313536146788206353403233486987190783560308488959136829451214825470593690476432312245433961, 2752401367253548733250686083465116623822808916527204934590319414928551678110079996283288773044557258530298428318089953171397357113169226739945076800082113932084130782871986278715141376766082523772705266871424933315451363066218215279533492036915502863019536238955357888138326952713321456657922998894213122971, 7506102541951447610352547605653500548855884332347661140547936149148468806500388170071960819717969484827586579541887788832678903040548497770217660048601139057442633971558719277813966423322980837681629612314298513079163154305941634210831310123437188217150502605104823056449452892763254366907730588098839490548, 18714108901975835719344238797234999842319235703740263886793617534663658596264816288174442862288281548837697491713358202927995493490340792204628154424205409557124919281649826993639825831150918855678505679860613459868907621773553930612789504260788223186608818730743283821002192655680200146877550686534967248027, 29281319235320991832756890688766207330634766161707926214930765209928156205566757237765919219513006281346023314941755546713488463114068248689566929575909932577972328385557778920405097191766763704208141808104005911309251261010591401314163880480714012174405709067064176535918033029827706227214379100743657304320, 22700835922325523386273157857462912714288299538061573880368844825744478994305157261211145416750450142674185575928658699919944266611795023385874235081224763842945231020935148740064558674320984738503312131512564740362243970264072250565380419904081384401152993110266582588310004659310042121233702632977562355011, 10200061370631873258484923420761828297849868785501998672932212286106321586939395654032673871373355483002444786824723959669794275953313877889887927131353001542625344392504028486734409978755901308519502259337539050409018324220869717601187446443397991376349167190714125440080410366317236922092494496927428397297, 22184680047370340898065518296644885792182965282466339710434099062257015175170252605340630284595140245713090334869030721521235826526587247141152113621168021009633883394423204854692253962233645928197442342120246618391158408092531169760270039514254446068633846607242835326886335136734234906898132002115572368438, 54093357146827574367406505256323503209566336636596784949727590852894586352572491156313679805595447054655087083913902823141702223571556440162463823909979551529567604674320367382543308679737775297602592282986774011479354455623253531025022193422357514835542282750945445460413496033974757947903492335530160996624, 11458989167690040776632413444325290912291022801575899133862400961793525951821732300384968836389665304186733257280490240396308356793958363634579498875700520782907160117705143599834428374261132922814397686403572867876067048795890439181804407550488084663779064195824171137574690687606277688131999327318791462694, 7891930714724007268759294091937621309886418210751362351691469149357630401899738880547916407302527919961172680054827941466702865421534407217988298917172581424345631189736119159412484392359413412071330318143318686789903031454543108978156431322149184809167154227129776760233911397642385033550498986624818304475, 46393397312485185649631425531633396591725277864922043020336838666690004296397486952093206339245390274309400165987852040483952797188888812757516474877634552208698486016877742045236784924096242859113650711491614131454097549342612883940489319966648186074871371496822318174251507991653191435598310784200323723551, 50782528288048611937427368556157973315032449586118570750320372814342577065588335196728456095220751865529208622203512775951992555475078636932237108300683439063595767631174562895714120914002175700303326695746001840103497664879886186397387243678606292234980192446142849035897460229818343674207337118528468291898, 20183922953948175217272665570236297755242018765260210633566802172712523507212018496264457737213091696681499118762295867089429775284234472226990696466236651280225110933637237298927963452151215077774988107200868977157226432449264324941036721940573706254315757810581991775987786469233624717404431906983231135042, 20399470332481521355380427042412080458490804234087078016500108038805829857053413427851495360948475382989887255845670865742618480651947138880558284928361552640873764255076364230363924271927868264709622152618394384342505016344629029807720994925636685103206004784428128462722829234218112586703398799947176170686, 35599368166479421202471024875696342716466466223749813050021076200509617730237277165522497746184103413686424155663121624879811350135946137208874008810413482798391153558543521477673789098943771953848364396298081934163954063151350565952035113191494949933754280587501254527673022177575951471215080003085962086516, 44125123432109736610958511990005983616109703131732731786078258517322565979428335514692700155364296384952276471836937145474653755324093867443909964625527530052465071631891899473090777660949511777608807648440113122112821612936364510861305204625890048627854797339715451650842867522257905125400260047068753622986, 17783080343566439115279395441872004337716529305967650262067370269385205714537668576481678880499152981637843819459182426407567067155976716349875961172073824283932574132182265336424851910550020547693376079547393737876569734606055069996655505864056852622242097443468270658879067925714474347624632795626468547781]

def gen_key():
    p = getPrime(512)
    q = getPrime(512)
    n = p*q
    e = 65537
    phi = (p-1)*(q-1)
    d = inverse(e,phi)
    return n,e,d

def encrypt(m,e,n):
    return pow(m,e,n)


def parse(f):
    return [f[i:i+2] for i in range(0,len(f),2)]


def main():
    n,e,d = gen_key()
    parts = (parse(FLAG))
    enc = [encrypt(bytes_to_long(p),e,n) for p in parts]
    print(f"n = {n}")
    print(f"e = {e}")
    print(f"enc = {enc}")


if __name__ == "__main__":
    main()
